<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Redimensionar Imagem com √çcone</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background: #f4f4f4;
    }

    input,
    select,
    button {
      margin: 5px;
      padding: 8px;
      font-size: 14px;
    }

    .small-btn {
      padding: 5px 12px;
      font-size: 13px;
      cursor: pointer;
      margin: 0 5px;
    }

    #download {
      display: none;
      margin-top: 15px;
      padding: 10px 20px;
      background: #0077cc;
      color: white;
      text-decoration: none;
      border-radius: 5px;
    }

    .info {
      margin: 10px 0;
      font-weight: bold;
    }

    #fileIcon {
      max-width: 60px;
      max-height: 60px;
      height: auto;
      width: auto;
      vertical-align: middle;
      display: none;
      border: 1px solid #ccc;
      margin-left: 10px;
    }

    .lang-btn {
      margin: 10px;
      padding: 8px 15px;
      cursor: pointer;
      border-radius: 5px;
      border: none;
      background: #0077cc;
      color: white;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <!-- Bot√µes de troca de idioma -->
  <button class="lang-btn" onclick="setLanguage('pt')">Portugu√™s</button>
  <button class="lang-btn" onclick="setLanguage('en')">English</button>

  <h1 id="title">üì∑ Redimensionar Imagem</h1>
  <p id="subtitle">Reduza ou aumente sua imagem gr√°tis em segundos.</p>

  <div>
    <input type="file" id="upload" accept="image/*">
    <img id="fileIcon" alt="√çcone da imagem">
  </div>

  <div class="info">
    <button class="small-btn" onclick="toggleFields('dim')" id="btnDim">Largura/Altura</button>
    <button class="small-btn" onclick="toggleFields('percent')" id="btnPercent">Porcentagem</button>
  </div>

  <div id="dimFields">
    <label id="labelWidth">Largura (px):</label>
    <input type="number" id="width" placeholder="Ex: 800" maxlength="4"><br>
    <label id="labelHeight">Altura (px):</label>
    <input type="number" id="height" placeholder="Ex: 600" maxlength="4"><br>
    <label><input type="checkbox" id="keepRatio"> <span id="labelKeepRatio">Manter propor√ß√£o</span></label><br>
  </div>

  <div id="percentField" style="display:none;">
    <label id="labelPercent">Porcentagem (%):</label>
    <input type="number" id="percent" placeholder="Ex: 50" maxlength="4"><br>
  </div>

  <label id="labelFormat">Formato de sa√≠da:</label>
  <select id="format">
    <option value="image/png">PNG</option>
    <option value="image/jpeg">JPG</option>
    <option value="image/webp">WebP</option>
  </select><br>
  <button onclick="resizeImage()" id="btnResize">Redimensionar</button>

  <p class="info"><u id="labelOriginal">Original</u></p>
  <p id="originalSize" class="info">Tamanho: -</p>
  <p id="originalDimensions" class="info">Dimens√µes: -</p>
  <p class="info"><u id="labelResized">Redimensionada</u></p>
  <p id="resizedSize" class="info">Tamanho: -</p>
  <p id="resizedDimensions" class="info">Dimens√µes: -</p>

  <canvas id="canvas" style="display:none;"></canvas><br>
  <a id="download">üì• Baixar Imagem</a>

  <script>
    let originalImage = new Image();
    let mode = 'dim';
    let aspectRatio = null;
    let lang = 'pt';

    const translations = {
      pt: {
        title: "üì∑ Redimensionar Imagem",
        subtitle: "Reduza ou aumente sua imagem gr√°tis em segundos.",
        btnDim: "Largura/Altura",
        btnPercent: "Porcentagem",
        labelWidth: "Largura (px):",
        labelHeight: "Altura (px):",
        labelKeepRatio: "Manter propor√ß√£o",
        labelPercent: "Porcentagem (%):",
        labelFormat: "Formato de sa√≠da:",
        btnResize: "Redimensionar",
        labelOriginal: "Original",
        labelResized: "Redimensionada",
        download: "üì• Baixar Imagem",
        size: "Tamanho",
        dimensions: "Dimens√µes",
        alertNoImage: "Carregue uma imagem primeiro.",
        alertInvalidPercent: "Informe uma porcentagem v√°lida.",
        alertInvalidDim: "Informe largura e/ou altura."
      },
      en: {
        title: "üì∑ Resize Image",
        subtitle: "Reduce or enlarge your image for free in seconds.",
        btnDim: "Width/Height",
        btnPercent: "Percentage",
        labelWidth: "Width (px):",
        labelHeight: "Height (px):",
        labelKeepRatio: "Keep aspect ratio",
        labelPercent: "Percentage (%):",
        labelFormat: "Output format:",
        btnResize: "Resize",
        labelOriginal: "Original",
        labelResized: "Resized",
        download: "üì• Download Image",
        size: "Size",
        dimensions: "Dimensions",
        alertNoImage: "Upload an image first.",
        alertInvalidPercent: "Enter a valid percentage.",
        alertInvalidDim: "Enter width and/or height."
      }
    };

    function setLanguage(selectedLang) {
      lang = selectedLang;
      const t = translations[lang];
      document.getElementById('title').textContent = t.title;
      document.getElementById('subtitle').textContent = t.subtitle;
      document.getElementById('btnDim').textContent = t.btnDim;
      document.getElementById('btnPercent').textContent = t.btnPercent;
      document.getElementById('labelWidth').textContent = t.labelWidth;
      document.getElementById('labelHeight').textContent = t.labelHeight;
      document.getElementById('labelKeepRatio').textContent = t.labelKeepRatio;
      document.getElementById('labelPercent').textContent = t.labelPercent;
      document.getElementById('labelFormat').textContent = t.labelFormat;
      document.getElementById('btnResize').textContent = t.btnResize;
      document.getElementById('labelOriginal').textContent = t.labelOriginal;
      document.getElementById('labelResized').textContent = t.labelResized;
      document.getElementById('download').textContent = t.download;
      // Atualizar textos de tamanho/dimens√µes para idioma selecionado
      document.getElementById('originalSize').textContent = t.size + ": -";
      document.getElementById('originalDimensions').textContent = t.dimensions + ": -";
      document.getElementById('resizedSize').textContent = t.size + ": -";
      document.getElementById('resizedDimensions').textContent = t.dimensions + ": -";
    }

    function toggleFields(selected) {
      mode = selected;
      document.getElementById('dimFields').style.display = selected === 'dim' ? 'block' : 'none';
      document.getElementById('percentField').style.display = selected === 'percent' ? 'block' : 'none';
      document.getElementById('width').value = '';
      document.getElementById('height').value = '';
      document.getElementById('percent').value = '';
    }

    document.getElementById('upload').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;

      const icon = document.getElementById('fileIcon');
      icon.src = URL.createObjectURL(file);
      icon.onload = () => URL.revokeObjectURL(icon.src);
      icon.style.display = 'inline-block';

      document.getElementById('originalSize').textContent =
        translations[lang].size + ': ' + formatBytes(file.size);

      const reader = new FileReader();
      reader.onload = function (ev) {
        originalImage.onload = function () {
          aspectRatio = originalImage.width / originalImage.height;
          document.getElementById('originalDimensions').textContent =
            translations[lang].dimensions + ': ' + originalImage.width + ' x ' + originalImage.height + ' px';
        };
        originalImage.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    });

    // Mant√©m propor√ß√£o
    document.getElementById('width').addEventListener('input', function () {
      if (document.getElementById('keepRatio').checked && aspectRatio) {
        const w = parseInt(this.value);
        if (w > 0) {
          document.getElementById('height').value = Math.round(w / aspectRatio);
        }
      }
    });

    document.getElementById('height').addEventListener('input', function () {
      if (document.getElementById('keepRatio').checked && aspectRatio) {
        const h = parseInt(this.value);
        if (h > 0) {
          document.getElementById('width').value = Math.round(h * aspectRatio);
        }
      }
    });

    // Limitar inputs a 4 caracteres
    ['width', 'height', 'percent'].forEach(id => {
      document.getElementById(id).addEventListener('input', function () {
        if (this.value.length > 4) {
          this.value = this.value.slice(0, 4);
        }
      });
    });

    function resizeImage() {
      if (!originalImage.src) {
        alert(translations[lang].alertNoImage);
        return;
      }

      let newW, newH;
      if (mode === 'percent') {
        const pct = parseInt(document.getElementById('percent').value);
        if (!pct || pct <= 0) {
          alert(translations[lang].alertInvalidPercent);
          return;
        }
        newW = originalImage.width * (pct / 100);
        newH = originalImage.height * (pct / 100);
      } else {
        const w = parseInt(document.getElementById('width').value);
        const h = parseInt(document.getElementById('height').value);
        if (!w && !h) {
          alert(translations[lang].alertInvalidDim);
          return;
        }
        newW = w || (originalImage.width * (h / originalImage.height));
        newH = h || (originalImage.height * (w / originalImage.width));
      }

      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = newW;
      canvas.height = newH;
      ctx.drawImage(originalImage, 0, 0, newW, newH);

      document.getElementById('resizedDimensions').textContent =
        translations[lang].dimensions + ': ' + Math.round(newW) + ' x ' + Math.round(newH) + ' px';

      const dataURL = canvas.toDataURL(document.getElementById('format').value);
      const sizeBytes = Math.ceil((dataURL.length - dataURL.indexOf(',') - 1) * 3 / 4);
      document.getElementById('resizedSize').textContent =
        translations[lang].size + ': ' + formatBytes(sizeBytes);

      const downloadLink = document.getElementById('download');
      downloadLink.href = dataURL;
      downloadLink.download = 'imagem-redimensionada.' +
        dataURL.substring(dataURL.indexOf('/') + 1, dataURL.indexOf(';'));
      downloadLink.style.display = 'inline-block';
    }

    function formatBytes(bytes) {
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      if (bytes === 0) return '0 Bytes';
      const i = Math.floor(Math.log(bytes) / Math.log(1024));
      return (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sizes[i];
    }
  </script>
</body>
</html>